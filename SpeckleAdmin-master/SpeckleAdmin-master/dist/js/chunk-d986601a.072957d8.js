(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d986601a"],{1966:function(e,t,s){"use strict";var r=s("73ac"),a=s.n(r);a.a},"50d6":function(e,t,s){},"73ac":function(e,t,s){},cb6a:function(e,t,s){"use strict";var r=s("50d6"),a=s.n(r);a.a},cf8c:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{"grid-list-xl":""}},[e.selectedStreams.length>0?s("v-toolbar",{staticStyle:{"z-index":"100"},attrs:{fixed:""}},[s("v-toolbar-items",[s("v-btn",{staticClass:"md-raised md-dense md-primary",attrs:{icon:"",color:"primary"},nativeOn:{click:function(t){return e.clearSelection(t)}}},[s("v-icon",[e._v("close")])],1),s("v-btn",{attrs:{flat:""},nativeOn:{click:function(t){return e.selectAll()}}},[e._v("select all")])],1),s("v-spacer"),s("v-toolbar-items",[s("v-btn",{attrs:{flat:"",color:"error"},nativeOn:{click:function(t){return e.deleteStreams(t)}}},[e._v("Archive")]),s("v-btn",{attrs:{flat:""},nativeOn:{click:function(t){return e.togglePermissions(t)}}},[e._v("Make "+e._s(e.defaultPermission))]),s("v-btn",{attrs:{flat:""},nativeOn:{click:function(t){return e.createProjectFromSelection(t)}}},[e._v("Create Project")])],1)],1):e._e(),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{staticClass:"headline font-weight-light",attrs:{xs12:"","py-5":""}},[e._v("\n      Streams are the channels your design data flows into.\n    ")]),0===e.streams.length?s("v-flex",{attrs:{xs12:""}},[s("p",{staticClass:"title font-weight-light"},[e._v("Hmm, you don't have any streams yet. Don't worry! You can create a new one here (big blue button in the lower right corner) or through "),s("router-link",{attrs:{to:"/plugins"}},[e._v("existing CAD integrations.")])],1)]):e._e(),s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{attrs:{solo:"",clearable:"",hint:e.searchHint,label:"Search for a stream","prepend-inner-icon":"search",spellcheck:"false",loading:e.isSearching,"append-icon":"refresh"},on:{input:e.updateSearch,"click:append":function(t){return e.$store.dispatch("getStreams","omit=objects,layers&isComputedResult=false&sort=updatedAt")}},model:{value:e.searchfilter,callback:function(t){e.searchfilter=t},expression:"searchfilter"}}),e.searchfilter&&""!==e.searchfilter?s("div",[s("p",{staticClass:"title font-weight-light my-3 mx-1"},[e._v("Found "+e._s(e.filteredStreams.length)+" streams matching your search criteria.")])]):e._e()],1)],1),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("v-btn",{attrs:{icon:"",small:"",disabled:0===e.pageNumber},nativeOn:{click:function(t){e.pageNumber=0}}},[s("v-icon",[e._v("first_page")])],1),s("v-btn",{attrs:{icon:"",small:"",disabled:0===e.pageNumber},nativeOn:{click:function(t){e.pageNumber-=1}}},[s("v-icon",[e._v("chevron_left")])],1),s("v-btn",{attrs:{icon:"",disabled:e.pageNumber>=Math.round(e.filteredStreams.length/e.sliceSize)},nativeOn:{click:function(t){e.pageNumber+=1}}},[s("v-icon",[e._v("chevron_right")])],1),s("v-btn",{attrs:{icon:"",small:"",disabled:e.pageNumber>=Math.round(e.filteredStreams.length/e.sliceSize)},nativeOn:{click:function(t){e.pageNumber=Math.round(e.filteredStreams.length/e.sliceSize)}}},[s("v-icon",[e._v("last_page")])],1),s("span",{staticClass:"caption",attrs:{xxxstyle:"position: relative;top:8px;"}},[e._v(e._s(e.pageNumber)+" / "+e._s((e.filteredStreams.length/e.sliceSize).toFixed(0)))])],1),e._l(e.paginatedStreams,function(t){return s("v-flex",{key:t._id,attrs:{xs12:"",sm6:""}},[s("stream-card",{attrs:{stream:t},on:{selected:e.selectThis,deleted:e.clearSelection}})],1)}),s("v-flex",{attrs:{xs12:""}},[s("v-btn",{attrs:{icon:"",small:"",disabled:0===e.pageNumber},nativeOn:{click:function(t){e.pageNumber=0}}},[s("v-icon",[e._v("first_page")])],1),s("v-btn",{attrs:{icon:"",small:"",disabled:0===e.pageNumber},nativeOn:{click:function(t){e.pageNumber-=1}}},[s("v-icon",[e._v("chevron_left")])],1),s("v-btn",{attrs:{icon:"",disabled:e.pageNumber>=Math.round(e.filteredStreams.length/e.sliceSize)},nativeOn:{click:function(t){e.pageNumber+=1}}},[s("v-icon",[e._v("chevron_right")])],1),s("v-btn",{attrs:{icon:"",small:"",disabled:e.pageNumber>=Math.round(e.filteredStreams.length/e.sliceSize)},nativeOn:{click:function(t){e.pageNumber=Math.round(e.filteredStreams.length/e.sliceSize)}}},[s("v-icon",[e._v("last_page")])],1),s("span",{staticClass:"caption",attrs:{xxxstyle:"position: relative;top:8px;"}},[e._v(e._s(e.pageNumber)+" / "+e._s((e.filteredStreams.length/e.sliceSize).toFixed(0)))])],1)],2),s("v-btn",{attrs:{color:"primary",dark:"",fixed:"",large:"",bottom:"",right:"",fab:""},nativeOn:{click:function(t){return e.createStream(t)}}},[s("v-icon",[e._v("add")])],1)],1)},a=[],i=(s("20d6"),s("6762"),s("2fdb"),s("28a5"),s("ac6a"),s("55dd"),s("f7fe")),n=s.n(i),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{class:{"stream-card":!0,"elevation-10":e.selected,"elevation-1":!0}},[s("v-card-title",[s("v-btn",{attrs:{icon:""},nativeOn:{click:function(t){return e.$router.push("/view/"+e.stream.streamId)}}},[s("v-icon",[e._v("360")])],1),s("span",{staticClass:"title font-weight-light"},[e._v(e._s(e.stream.name?e.stream.name:"Stream Has No Name"))]),s("v-spacer"),s("span"),s("span",[s("v-checkbox",{attrs:{color:"primary"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)],1),s("v-divider",{staticClass:"mx-0 my-0"}),s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{staticClass:"caption",attrs:{xs12:"","ma-2":""}},[s("v-icon",{attrs:{small:""}},[e._v("fingerprint")]),e._v(" "),s("strong",{staticStyle:{"user-select":"all"}},[e._v(e._s(e.stream.streamId))]),e._v(" \n      "),s("v-icon",{attrs:{small:""}},[e._v("edit")]),e._v(" "),s("timeago",{attrs:{datetime:e.stream.updatedAt}}),e._v(" \n      "),s("v-icon",{attrs:{small:""}},[e._v("access_time")]),e._v("  "+e._s(e.createdAt)+" \n      "),s("v-icon",{attrs:{small:""}},[e._v(e._s(e.stream.private?"lock":"lock_open"))]),e._v(" link sharing "+e._s(e.stream.private?"off":"on")+"  \n      "),s("v-icon",{attrs:{small:""}},[e._v("person_outline")]),e._v(" "+e._s(e.allUsers.length)+"  \n      "),s("v-icon",{attrs:{small:""}},[e._v("history")]),e._v(" "+e._s(e.stream.children.length)+"  \n    ")],1),e.stream.tags.length>0?s("v-flex",{attrs:{xs12:"","ma-2":""}},e._l(e.stream.tags,function(t){return s("v-chip",{key:t,attrs:{small:"",outline:""}},[e._v(e._s(t))])}),1):e._e(),s("v-flex",{attrs:{xs12:"","ma-2":""}},[s("div",{staticClass:"md-caption md-small-hide",domProps:{innerHTML:e._s(e.compiledDescription)}})])],1),s("v-card-actions",[s("span",{staticClass:"caption font-weight-light"},[e._v("Owned by "+e._s(e.owner))]),s("v-spacer"),s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.isOwner,expression:"isOwner"}],staticClass:"transparent",attrs:{depressed:""},nativeOn:{click:function(t){return e.deleteStream(t)}}},[e._v("Archive")]),s("v-btn",{attrs:{color:"primary",to:"/streams/"+e.stream.streamId}},[e._v("Details")])],1)],1)},l=[],o=(s("7f7f"),s("7514"),s("13bb")),u=s.n(o),d=s("0e54"),m=s.n(d),h={name:"StreamCard",props:{stream:Object},watch:{selected:function(){this.$emit("selected",this.stream)}},computed:{createdAt:function(){var e=new Date(this.stream.createdAt);return e.toLocaleString("en",{year:"numeric",month:"long",day:"numeric"})},compiledDescription:function(){return m()(this.stream.description.substring(0,220)+" ...",{sanitize:!0})},canEdit:function(){return!!this.isOwner||-1!==this.stream.canWrite.indexOf(this.$store.state.user._id)},isOwner:function(){return this.stream.owner===this.$store.state.user._id},allUsers:function(){return u()(this.stream.canRead,this.stream.canWrite)},owner:function(){var e=this,t=this.$store.state.users.find(function(t){return t._id===e.stream.owner});return t||this.$store.dispatch("getUser",{_id:this.stream.owner}),t?t.surname.includes("is you")?"you":"".concat(t.name," ").concat(t.surname):"Loading"}},data:function(){return{selected:!1}},methods:{deleteStream:function(){this.$store.dispatch("updateStream",{streamId:this.stream.streamId,deleted:!0}),this.$emit("deleted")},updateTags:n()(function(e){this.$store.dispatch("updateStream",{streamId:this.stream.streamId,tags:this.stream.tags})},1e3)},mounted:function(){var e=this;bus.$on("select-stream",function(t){e.stream.streamId===t&&(e.selected=!0)}),bus.$on("unselect-all",function(){e.selected=!1})}},v=h,f=(s("cb6a"),s("2877")),p=Object(f["a"])(v,c,l,!1,null,"5fea8438",null);p.options.__file="StreamCard.vue";var g=p.exports,_={name:"StreamsView",components:{StreamCard:g},computed:{streams:function(){return this.$store.state.streams.filter(function(e){return null==e.parent&&!1===e.deleted}).sort(function(e,t){return new Date(t.updatedAt)-new Date(e.updatedAt)})},filteredStreams:function(){return this.$store.getters.filteredStreams(this.filters)},paginatedStreams:function(){return this.filteredStreams.slice(this.currentIndex+this.pageNumber*this.sliceSize,this.sliceSize*(this.pageNumber+1))}},data:function(){return{currentIndex:0,sliceSize:6,pageNumber:0,selectedStreams:[],searchfilter:"",filters:[],defaultPermission:"private",isSearching:!1,searchHint:"You can restrict your search to the stream's id by prepending id:{your stream id}, similarly for name, tags etc."}},watch:{searchfilter:function(){this.isSearching=!0},selectedStreams:function(){var e=0,t=0;this.selectedStreams.forEach(function(s){s.private?e++:t++}),this.defaultPermission=e>t?"public":"private"}},methods:{createStream:function(){var e=this;this.$store.dispatch("createStream",{name:"A New Speckle Stream",onlineEditable:!0}).then(function(t){e.$router.push("/streams/".concat(t.streamId))}).catch(function(e){console.error(e)})},createProjectFromSelection:function(){var e=this;this.$store.dispatch("createProject",{name:"Speckle Project",streams:this.selectedStreams.map(function(e){return e.streamId})}).then(function(t){e.clearSelection(),e.$router.push("/projects/".concat(t._id))})},togglePermissions:function(){var e=this;this.selectedStreams.forEach(function(t){e.$store.dispatch("updateStream",{streamId:t.streamId,private:"private"===e.defaultPermission})}),this.defaultPermission="private"===this.defaultPermission?"public":"private"},deleteStreams:function(){var e=this;this.selectedStreams.forEach(function(t){e.$store.dispatch("updateStream",{streamId:t.streamId,deleted:!0})}),this.clearSelection()},updateSearch:n()(function(e){this.pageNumber=0,this.isSearching=!1,this.searchfilter=e;try{var t=this.searchfilter.split(" ").map(function(e){return e.includes(":")?{key:e.split(":")[0],value:e.split(":")[1]}:e.includes("public")||e.includes("private")||e.includes("mine")||e.includes("shared")?{key:e,value:null}:{key:"name",value:e}});this.filters=t}catch(s){this.filters=[{key:"name",value:e}]}},1e3),selectAll:function(){var e=this;this.paginatedStreams.forEach(function(t){var s=e.selectedStreams.findIndex(function(e){return e.streamId===t.streamId});-1===s&&bus.$emit("select-stream",t.streamId)})},selectThis:function(e){var t=this.selectedStreams.findIndex(function(t){return t.streamId===e.streamId});-1===t?this.selectedStreams.unshift(e):this.selectedStreams.splice(t,1)},clearSelection:function(){this.defaultPermission="private",bus.$emit("unselect-all")},checkSelection:function(){this.selectedStreams=this.selectedStreams.filter(function(e){return!e.deleted})}},created:function(){}},b=_,S=(s("1966"),Object(f["a"])(b,r,a,!1,null,"2180ff90",null));S.options.__file="Streams.vue";t["default"]=S.exports}}]);
//# sourceMappingURL=chunk-d986601a.072957d8.js.map